{% extends 'basemanager.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<style>
/* N√∫t CH·ªàNH S·ª¨A m√†u xanh */
.btn-edit-request {
    background-color: #2563eb;   /* xanh */
    border: none;
    border-radius: 8px;
    padding: 8px 18px;
    font-weight: 600;
    color: #fff;
    font-size: 14px;
}

.btn-edit-request:hover {
    background-color: #1d4ed8;
    color: #fff;
}

/* N√∫t X√ìA Y√äU C·∫¶U m√†u ƒë·ªè + icon */
.btn-delete-request {
    background-color: #ef4444;   /* ƒë·ªè */
    border: none;
    border-radius: 8px;
    padding: 8px 18px;
    font-weight: 600;
    color: #fff;
    font-size: 14px;
    display: inline-flex;
    align-items: center;
    gap: 6px;                    /* kho·∫£ng c√°ch icon ‚Äì ch·ªØ */
}

.btn-delete-request:hover {
    background-color: #dc2626;
    color: #fff;
}

/* B·ªè vi·ªÅn/outline khi focus ƒë·ªÉ kh√¥ng b·ªã ‚Äúl·ªìi‚Äù */
.btn-edit-request:focus,
.btn-delete-request:focus {
    outline: none;
    box-shadow: none;
}
.btn-group-space {
    display: flex;
    justify-content: end;
    gap: 10px;   /* ch·ªânh kho·∫£ng c√°ch t√πy √Ω */
}
</style>

<div class="container my-5">
    <h1 class="text-center fw-bold mb-3">{{ title }}</h1>
    <p class="text-center text-muted mb-5">G·ª≠i y√™u c·∫ßu tuy·ªÉn d·ª•ng v√† qu·∫£n l√Ω y√™u c·∫ßu ƒë√£ g·ª≠i</p>

    <div class="row">
        <!-- C·ªôt tr√°i: Form g·ª≠i y√™u c·∫ßu -->
        <div class="col-md-4 mb-4">
            <div class="card shadow-sm p-4">
                <h5 class="fw-bold mb-3">G·ª≠i Y√™u C·∫ßu Tuy·ªÉn D·ª•ng</h5>
                <form method="post">
                    {% csrf_token %}
                    {% for field in form %}
                        <div class="mb-3">
                            <label class="form-label">{{ field.label }}</label>
                            {{ field }}
                            {% if field.errors %}
                                <div class="text-danger small">{{ field.errors }}</div>
                            {% endif %}
                        </div>
                    {% endfor %}
                    <button type="submit" class="btn btn-primary w-100">
                        G·ª≠i Y√™u C·∫ßu
                    </button>
                </form>
            </div>
        </div>

        <!-- C·ªôt ph·∫£i: Danh s√°ch y√™u c·∫ßu ƒë√£ g·ª≠i -->
        <div class="col-md-8">
            <div class="card shadow-sm p-4">
                <h5 class="fw-bold mb-4">Danh S√°ch Y√™u C·∫ßu ƒê√£ G·ª≠i ({{ all_requests.count }})</h5>

                {% for request in all_requests %}
                <div class="border rounded p-3 mb-3">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="fw-bold">{{ request.request_name }}</h5>
                        <span class="badge
                            {% if request.request_status == "CONSIDERING" %} bg-warning
                            {% elif request.request_status == "ACCEPTED" %} bg-success
                            {% else %} bg-danger
                            {% endif %}"> {{ request.get_request_status_display }}
                        </span>
                    </div>

                    <p class="text-muted mb-1">
                        {{ request.department }} | {{ request.recruitment_position }} | {{ request.date_requested|date:"d/m/Y" }}
                    </p>
                    <p>{{ request.reason|truncatechars:100 }}</p>

                    <div class="btn-group-space">
                        <a href="{% url 'edit_recruitment_request' request.id %}" class="btn btn-edit-request">
                            Ch·ªânh s·ª≠a
                        </a>

                        <form action="{% url 'delete_recruitment_request' request.id %}" method="post"
                              onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a y√™u c·∫ßu n√†y kh√¥ng?');">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-delete-request">
                                üóëÔ∏è X√≥a y√™u c·∫ßu
                            </button>
                        </form>
                    </div>

                </div>
                {% empty %}
                    <p class="text-center text-muted mb-0">Ch∆∞a c√≥ y√™u c·∫ßu n√†o ƒë∆∞·ª£c g·ª≠i.</p>
                {% endfor %}

            </div>
        </div>
    </div>
</div>
{% endblock %}